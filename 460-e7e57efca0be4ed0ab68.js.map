{"version":3,"sources":["webpack:///./src/terra-dev-site/tool/DockerDevelopmentEnvironment.tool.mdx"],"names":["layoutProps","MDXContent","components","props","mdxType","parentName","isMDXComponent"],"mappings":"iuBAQA,IAAMA,EAAc,GAIL,SAASC,EAAT,GAGZ,IAFDC,EAEC,EAFDA,WACGC,EACF,oBACD,OAAO,cALS,UAKT,KAAeH,EAAiBG,EAAhC,CAAuCD,WAAYA,EAAYE,QAAQ,cAC5E,mBAAQ,CACN,GAAM,kCADR,kCAGA,yMACA,mBAAQ,CACN,GAAM,YADR,YAGA,sIAAmH,4BAAYC,WAAW,KAAvB,OAAnH,KACA,mBAAQ,CACN,GAAM,eADR,eAGA,yQACA,mBAAQ,CACN,GAAM,6BADR,6BAGA,wNACA,mBAAQ,CACN,GAAM,wBADR,WAEe,4BAAYA,WAAW,MAAvB,iBACf,0FAAuE,4BAAYA,WAAW,KAAvB,gBAAvE,+DACA,wBACE,oBAAIA,WAAW,MAAf,6FACA,oBAAIA,WAAW,MAAf,uDAA4E,4BAAYA,WAAW,MAAvB,eAA5E,8FAAmO,4BAAYA,WAAW,MAAvB,eAAnO,gEAA4V,4BAAYA,WAAW,MAAvB,gBAA5V,uCAA6b,4BAAYA,WAAW,MAAvB,gBAA7b,cAAqgB,4BAAYA,WAAW,MAAvB,eAArgB,6BAEF,mBAAQ,CACN,GAAM,sBADR,sBAGA,qFACA,yBAAK,wBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,2BAIL,mBAAQ,CACN,GAAM,cADR,cAGA,+EACA,yBAAK,wBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,6CAIL,iGAA8E,4BAAYA,WAAW,KAAvB,gBAA9E,qJAA4R,4BAAYA,WAAW,KAAvB,iBAA5R,wDACA,mBAAQ,CACN,GAAM,WADR,WAGA,oDAAiC,4BAAYA,WAAW,KAAvB,mBAAjC,6HACA,mBAAQ,CACN,GAAM,qBADR,qBAGA,4FACA,yBAAK,wBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,0BAIL,2HACA,mBAAQ,CACN,GAAM,4BADR,4BAGA,4QACA,uCACA,uCACA,yBAAK,wBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,oEAML,6CACA,yBAAK,wBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,0PAeL,mBAAQ,CACN,GAAM,sCADR,sCAGA,2IACA,yBAAK,wBAAMA,WAAW,OAAU,CAC5B,UAAa,kBADZ,mEAIL,mBAAQ,CACN,GAAM,mBADR,mBAGA,mBAAQ,CACN,GAAM,yBADR,0BAGA,8RAA2Q,4BAAYA,WAAW,KAAvB,gBAA3Q,6EACA,mBAAQ,CACN,GAAM,wCADR,wCAGA,6FAA0E,4BAAYA,WAAW,KAAvB,gBAA1E,sGAAyO,4BAAYA,WAAW,KAAvB,gBAAzO,kIAAoa,4BAAYA,WAAW,KAAvB,gBAApa,4CAKJJ,EAAWK,gBAAiB","file":"460-e7e57efca0be4ed0ab68.js","sourcesContent":["\nimport React from 'react'\nimport { mdx } from '@mdx-js/react'\n\n/* @jsx mdx */\n\n\n\nconst layoutProps = {\n  \n};\nconst MDXLayout = \"wrapper\"\nexport default function MDXContent({\n  components,\n  ...props\n}) {\n  return <MDXLayout {...layoutProps} {...props} components={components} mdxType=\"MDXLayout\">\n    <h1 {...{\n      \"id\": \"docker-development-environment\"\n    }}>{`Docker Development Environment`}</h1>\n    <p>{`Terra provides a docker development environment that allows developers access to a common environment to develop Terra components regardless of the OS they are developing on.`}</p>\n    <h2 {...{\n      \"id\": \"services\"\n    }}>{`Services`}</h2>\n    <p>{`In each Terra repository there is a docker-compose.yml file that defines several services, most importantly `}<inlineCode parentName=\"p\">{`dev`}</inlineCode>{`.`}</p>\n    <h3 {...{\n      \"id\": \"dev-service\"\n    }}>{`Dev Service`}</h3>\n    <p>{`The dev service provides a linux environment with node, npm and the zsh terminal pre-installed. By default the dev service volume mounts the entire local repo directory into the docker container to enable hot reloading during development.`}</p>\n    <h3 {...{\n      \"id\": \"standalone-chrome-service\"\n    }}>{`Standalone Chrome Service`}</h3>\n    <p>{`Terra's webdriver.io integration tests must run against selenium standalone-chrome node, so this service is required to run wdio tests. It is started alongside the dev and test-ci services.`}</p>\n    <h2 {...{\n      \"id\": \"sharing-node_modules\"\n    }}>{`Sharing `}<inlineCode parentName=\"h2\">{`node_modules`}</inlineCode></h2>\n    <p>{`The docker development environment intentionally will write out `}<inlineCode parentName=\"p\">{`node_modules`}</inlineCode>{` to the shared host volume. This provides several benefits:`}</p>\n    <ul>\n      <li parentName=\"ul\">{`Simpler volume mounting, everything edited in the repo is shared to the docker container.`}</li>\n      <li parentName=\"ul\">{`Node module caching. For the development containers `}<inlineCode parentName=\"li\">{`npm install`}</inlineCode>{` is run at run time of the docker container (opposed to build time). This is done to allow `}<inlineCode parentName=\"li\">{`npm install`}</inlineCode>{` to discover local dependencies. To avoid long startup times `}<inlineCode parentName=\"li\">{`node_modules`}</inlineCode>{` are cached to the local volume. If `}<inlineCode parentName=\"li\">{`node_modules`}</inlineCode>{` are found `}<inlineCode parentName=\"li\">{`npm install`}</inlineCode>{` is not run at run time.`}</li>\n    </ul>\n    <h2 {...{\n      \"id\": \"before-development\"\n    }}>{`Before Development`}</h2>\n    <p>{`To build all the services in the docker-compose file, run:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`docker-compose build\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"developing\"\n    }}>{`Developing`}</h2>\n    <p>{`To get started developing with the dev service, run:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`docker-compose run --service-ports dev\n`}</code></pre>\n    <p>{`This will start the docker container for the repo, run npm install (if `}<inlineCode parentName=\"p\">{`node_modules`}</inlineCode>{` are not detected)  and then launch the zsh terminal. Then you're free to use your favorite editor to manipulate the code in the repo. Simply run `}<inlineCode parentName=\"p\">{`npm run start`}</inlineCode>{` once the terminal has launched to start the server.`}</p>\n    <h2 {...{\n      \"id\": \"testing\"\n    }}>{`Testing`}</h2>\n    <p>{`It is required to use the `}<inlineCode parentName=\"p\">{`--service-ports`}</inlineCode>{` flag when running either service to run wdio tests from the docker container. This maps the service's ports to the host.`}</p>\n    <h2 {...{\n      \"id\": \"after-development\"\n    }}>{`After development`}</h2>\n    <p>{`After you've finished running development (or periodically), run:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`docker-compose down\n`}</code></pre>\n    <p>{`This will stop the standalone-chrome service that will otherwise be left running on your device.`}</p>\n    <h2 {...{\n      \"id\": \"using-local-dependencies\"\n    }}>{`Using Local Dependencies`}</h2>\n    <p>{`Local dependencies are supported in the docker development environment, but require an additional step. For the docker container to be able to find the local dependency, it must be volume mounted to the docker container from the dev service.`}</p>\n    <p>{`For example:`}</p>\n    <p>{`package.json`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-json\"\n      }}>{`\"dependencies\": {\n    \"classnames\": \"file:../classnames\",\n}\n`}</code></pre>\n    <p>{`docker-compose.yml`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-diff\"\n      }}>{`dev:\n  image: \"terra-ui:dev\"\n  build:\n    context: ./\n    args:\n      - npm_install=false\n  ports:\n    - 8080:8080\n  volumes:\n    - .:/opt/module\n+    # This is the local dependency volume mount.\n+    - ../classnames:/opt/classnames\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"other-ways-to-run-the-zsh-terminal\"\n    }}>{`Other Ways to Run the Zsh Terminal`}</h2>\n    <p>{`It is also possible to run the Zsh terminal on a docker container. To attach to a running docker container, run:`}</p>\n    <pre><code parentName=\"pre\" {...{\n        \"className\": \"language-bash\"\n      }}>{`docker exec -it <hash for running docker container> /bin/zsh\n`}</code></pre>\n    <h2 {...{\n      \"id\": \"troubleshooting\"\n    }}>{`Troubleshooting`}</h2>\n    <h3 {...{\n      \"id\": \"error-missing-binding\"\n    }}>{`Error: Missing binding`}</h3>\n    <p>{`This error means that a node_module install for one environment is being run in another. Likely this means that you ran npm install on your host OS and are now trying to use that module in your docker container or the opposite. To resolve the issue delete the `}<inlineCode parentName=\"p\">{`node_modules`}</inlineCode>{` folder and run npm_install where you are attempting to start the server.`}</p>\n    <h3 {...{\n      \"id\": \"dependency-changes-not-taking-effect\"\n    }}>{`Dependency changes not taking effect`}</h3>\n    <p>{`npm install is triggered at run time of the docker container. If a `}<inlineCode parentName=\"p\">{`node_modules`}</inlineCode>{` directory is found npm install will not run. If dependencies have changed the script checking for `}<inlineCode parentName=\"p\">{`node_modules`}</inlineCode>{` isn't smart enough to re-run npm install. To resolve the issue either terminate the service and run npm install or delete the `}<inlineCode parentName=\"p\">{`node_modules`}</inlineCode>{` folder and rerun the docker container.`}</p>\n    </MDXLayout>;\n}\n\n;\nMDXContent.isMDXComponent = true;"],"sourceRoot":""}